<!DOCTYPE html>
<html data-bs-theme="light" lang="en" style="background: var(--bs-body-bg);">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Untitled</title>
    <link rel="stylesheet" href="static/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800&amp;display=swap">
    <link rel="stylesheet" href="static/css/Bootstrap-Calendar.css">
    <link rel="stylesheet" href="static/css/Navbar-Right-Links-Dark-icons.css">
</head>

<body>
    <header class="bg-dark" style="margin-bottom: 0px;padding-bottom: 29px;background: rgb(39, 38, 46);">
        <div class="container pt-4 pt-xl-5">
          <nav class="navbar navbar-expand-md bg-dark py-3" data-bs-theme="dark" style="margin-left: -1px;padding-top: 0px;margin-top: -49px;padding-left: 0px;">
            <div class="container"><a class="navbar-brand d-flex align-items-center" href="/"><span class="bs-icon-sm bs-icon-rounded d-flex justify-content-center align-items-center me-2 bs-icon" style="margin-bottom: 0px;margin-left: 0px;padding-left: 0px;"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" style="padding-top: 0px;margin-top: 0px;margin-bottom: 0px;padding-left: 0px;padding-right: 0px;font-size: 38px;">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M3 6C3 4.89543 3.89543 4 5 4H19C20.1046 4 21 4.89543 21 6V14C21 15.1046 20.1046 16 19 16H5C3.89543 16 3 15.1046 3 14V6ZM5 6H19V14H5V6Z" fill="currentColor"></path>
                            <path d="M2 18C1.44772 18 1 18.4477 1 19C1 19.5523 1.44772 20 2 20H22C22.5523 20 23 19.5523 23 19C23 18.4477 22.5523 18 22 18H2Z" fill="currentColor"></path>
                        </svg></span><span class="text-capitalize fs-5 fw-bold">Magazin Componente IT</span></a><button data-bs-toggle="collapse" class="navbar-toggler" data-bs-target="#navcol-5"><span class="visually-hidden">Toggle navigation</span><span class="navbar-toggler-icon"></span></button>
                <div class="collapse navbar-collapse" id="navcol-5" style="margin-right: -126px;padding-left: 0px;margin-left: -5px;"><input class="mx-auto" type="search" placeholder="Cautati produse (ID/Nume)" style="font-size: 18px;border-radius: 16px;border-color: transparent;">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item"><a class="active fw-light" id="adaugareprodus" href="/adaugareprodus" style="margin-right: 0px;">Adaugare produs nou</a></li>
                        <li class="nav-item"></li>
                        <li class="nav-item"></li>
                    </ul><a class="active fw-light" href="#" style="margin-left: 15px;">Istoric comenzi</a><a class="nav-link active fw-light" id="vizualizare" href="/vizualizare" style="margin-left: 15px;">Vizualizare inventar</a><a class="btn btn-primary btn-sm fw-normal" id="logout" href="/logout" style="background: var(--bs-red);color: var(--bs-black);font-size: 16px;margin-left: 16px;border-color: transparent;">Logout</a>
                </div>
            </div>
        </nav>
            <div class="row pt-5">
                <div class="col">
                    <h1 class="fw-bold">Total produse:&nbsp;</h1>
                    <p class="fs-5 fw-bold mb-2">{{numar_produse}}</p>
                </div>
                <div class="col-md-8 col-xl-6 text-center text-md-start mx-auto">
                    <div class="text-center"></div>
                    <h1>{{data}}</h1>
                </div>
                <div class="col-12 col-lg-10 mx-auto">
                    <div class="position-relative" style="display: flex;flex-wrap: wrap;justify-content: flex-end;">
                        <div style="position: relative;flex: 0 0 45%;transform: translate3d(-15%, 35%, 0);"></div>
                        <div style="position: relative;flex: 0 0 45%;transform: translate3d(-5%, 20%, 0);"></div>
                        <div style="position: relative;flex: 0 0 60%;transform: translate3d(0, 0%, 0);"></div>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <div class="table-responsive text-center" style="padding: 100px;padding-right: 250px;padding-left: 250px;background: var(--bs-body-bg);">
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
        <div class="alert alert-success" role="alert" id="flash-messages">
            {% for category, message in messages %}
            <li class="{{ category }}">{{ message }}</li>
          {% endfor %}
        </div>
        <script>
            setTimeout(function() {
                var flashMessages = document.getElementById('flash-messages');
                if (flashMessages) {
                    flashMessages.style.display = 'none';
                }
            }, 3000); 
        </script>
        {% endif %}
      {% endwith %}
        <table class="table table-bordered">
            <thead>
                <tr class="table-dark">
                    <th class="fs-6 border rounded-0 border-1" style="background: rgb(39, 38, 46);color: var(--bs-body-color);border-color: #ffffff;">ID</th>
                    <th class="fs-6 border rounded-0 border-1" style="background: rgb(39, 38, 46);color: var(--bs-body-color);border-color: #ffffff;">Marca</th>
                    <th class="fs-6 border rounded-0 border-1" style="background: rgb(39, 38, 46);color: var(--bs-body-color);border-color: #ffffff;">Model</th>
                    <th class="fs-6 border rounded-0 border-1" style="background: rgb(39, 38, 46);color: var(--bs-body-color);border-color: #ffffff;">Pret</th>
                    <th class="fs-6 border rounded-0 border-1" style="background: rgb(39, 38, 46);color: var(--bs-body-color);border-color: #ffffff;">Stoc</th>
                    <th class="fs-6 border rounded-0 border-1" style="background: rgb(39, 38, 46);color: var(--bs-body-color);border-color: #ffffff;">Categorie</th>
                    <th class="fs-6 border rounded-0 border-1" style="background: rgb(39, 38, 46);color: var(--bs-body-color);border-color: #ffffff;">Actiuni</th>
                </tr>
            </thead>
            <tbody>
                {%for Produse in query%}
                <tr>
                    <td class="fs-6 border rounded-0 border-1" style="background: rgb(39, 38, 46);color: var(--bs-body-color);border-color: #ffffff;">{{Produse.cod}}</td>
                    <td class="fs-6 border rounded-0 border-1" style="background: rgb(39, 38, 46);color: var(--bs-body-color);border-color: #ffffff;">{{Produse.marca}}</td>
                    <td class="fs-6 border rounded-0 border-1" style="background: rgb(39, 38, 46);color: var(--bs-body-color);border-color: #ffffff;">{{Produse.model}}</td>
                    <td class="fs-6 border rounded-0 border-1" style="color: var(--bs-body-color);background: rgb(39, 38, 46);border-color: #ffffff;">{{Produse.pret}}</td>
                    <td class="fs-6 border rounded-0 border-1" style="color: var(--bs-body-color);background: rgb(39, 38, 46);border-color: #ffffff;">{{Produse.stoc}}</td>
                    <td class="fs-6 border rounded-0 border-1" style="color: var(--bs-body-color);background: rgb(39, 38, 46);border-color: #ffffff;">{{Produse.categorie}}</td>
                    <td class="fs-6 text-center border rounded-0 border-1" style="background: rgb(39, 38, 46);color: var(--bs-body-color);border-color: #ffffff;"><button class="btn btn-primary btn-sm" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="border-radius: 31px;padding: 7.4px 24px;padding-right: 23px;padding-left: 24px;width: 60.5px;margin: 0px;margin-right: 0px;position: relative;display: inline;">...</button>
                        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                            <button class="dropdown-item actualizati-produsul" type="button" data-bs-toggle="modal" data-bs-target="#actualizareModal">Actualizati produsul</button>
                            <button class="dropdown-item stergeti-produsul" type="button" data-bs-toggle="modal" data-bs-target="#stergereModal">Stergeti produsul</button>
                        </div></td>
                </tr>
                {%endfor%}
                
            </tbody>
        </table>
    </div>
    <!-- Modal modificare -->
<div class="modal fade" id="actualizareModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Actualizare produs</h5>
        </div>
        <div class="modal-body">
            <form method="POST">
                <input type="hidden" name="cod" id="cod">
                <div class="mb-3">
                    <input class="form-control" type="text" placeholder="Marca produsului" id="marca" name="marca" style="margin-bottom: 25px;margin-top: 4px;">
                    <input class="form-control" type="text" id="model" name="model" placeholder="Introduceti modelul" style="margin-bottom: 25px;">
                    <select class="form-select" id="categorie" name="categorie" style="margin-bottom: 25px;">
                           <option>Placi de baza</option>
            <option>Procesoare</option>
            <option>Memorii RAM</option>
            <option>Componente stocare(SSD)</option>
            <option>Componente stocare(HDD)</option>
            <option>Placi video</option>
            <option>Surse de alimentare</option>
            <option>Carcase</option>
            <option>Ventilatoare/radiatoare</option>
            <option>Unelte</option>
            <option>Placi de sunet</option>
            <option>Placi de captura</option>
            <option>Monitoare</option>
            <option>Retelistica & UPS</option>
            <option>Periferice</option>
            <option>Altele</option>
                    </select>
                    <input class="form-control" type="number" id="pret" name="pret" placeholder="Introduceti pretul" style="margin-bottom: 25px;">
                    <input class="form-control" type="number" id="stoc" name="stoc" placeholder="Introduceti stocul" style="margin-bottom: 25px;">
                    <textarea class="form-control" id="descriere" name="descriere" rows="6" placeholder="Introduceti o descriere a produsului" style="margin-bottom: 25px;"></textarea>
                    <span class="text-center d-block" style="margin-bottom: 5px;">Selectati o poza a produsului</span>

                    <input class="form-control" type="file" value="{{Produse.imagine}}" style="margin-bottom: 25px;">

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Anulare</button>
                    <!-- Remove the second type attribute -->
                    <button class="btn btn-primary" type="submit">Salvati modificarile</button>
                </div>
            </form>        
        </div>
      </div>
    </div>
  </div>
<!--Modal Stergere-->  
<div class="modal fade" id="stergereModal"tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Se va sterge produsul: 
        </div>
        <div class="modal-body">
            <form method="POST" action="/stergereprodus">
                <input type="hidden" name="cod-stergere" id="cod-stergere">
                <div class="mb-3">
                    <ul>
                    <li>
                    <h5 id="marca-stergere" class="d-inline"></h5>
                    <h5 id="model-stergere" class="d-inline"></h5>
                    </li>
                    </ul> 
                </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Anulare</button>
          <button class="btn btn-danger" type="submit">Stergeti</button>
        </div>

            

</form>
      </div>
    </div>
  </div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="static/js/bold-and-dark.js"></script>
<script>
        $(document).ready(function() {
            $('.actualizati-produsul').on('click',function() {
                $('#actualizareModal').modal('show');
           $tr=$(this).closest('tr');
           var data=$tr.children("td").map(function(){
            return $(this).text();
           }).get();
           $('#cod').val(data[0]);
           $('#marca').val(data[1]);
           $('#model').val(data[2]);
           $('#pret').val(data[3]);
           $('#stoc').val(data[4]);
           $('#categorie').val(data[5]);
            });          
});
    </script>
    <script>
                $(document).ready(function() {
            $('.stergeti-produsul').on('click',function() {
                $('#stergereModal').modal('show');
           var $tr=$(this).closest('tr');
           var data=$tr.children("td").map(function(){
            return $(this).text();
           }).get();
           $('#cod-stergere').val(data[0]);
           $('#marca-stergere').text(data[1]);
           $('#model-stergere').text(data[2]);
            });  
        });     
    </script>
</body>
</html>